<div class="read-more" id="read-more-{{ nth }}">
    <div class="preview">
        {{ preview | safe }}
        {% if inline_more is not defined or inline_more %}
        <a href="#" class="toggle-read-more read-more-link">Read More</a>
        {% endif %}
    </div>
    <div class="full-content" style="display: none;">
        {{ body | safe }}
        {% if inline_less is not defined or inline_less %}
        <a href="#" class="toggle-read-more read-less-link" style="display: none;">Read Less</a>
        {% endif %}
    </div>
    {% if (inline_more is defined and not inline_more) and (inline_less is defined and not inline_less) %}
    <a href="#" class="toggle-read-more standalone-link">Read More</a>
    {% endif %}
</div>

<script>
(function() {
    const container = document.getElementById('read-more-{{ nth }}');
    const preview = container.querySelector('.preview');
    const fullContent = container.querySelector('.full-content');
    const toggles = container.querySelectorAll('.toggle-read-more');
    
    toggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            if (fullContent.style.display === 'none') {
                preview.style.display = 'none';
                fullContent.style.display = 'block';
                container.querySelectorAll('.read-more-link, .standalone-link').forEach(el => el.style.display = 'none');
                container.querySelectorAll('.read-less-link').forEach(el => el.style.display = 'inline');
            } else {
                preview.style.display = 'block';
                fullContent.style.display = 'none';
                container.querySelectorAll('.read-more-link, .standalone-link').forEach(el => el.style.display = 'inline');
                container.querySelectorAll('.read-less-link').forEach(el => el.style.display = 'none');
            }
        });
    });
})();
</script>
